{"ast":null,"code":"import React,{useEffect,useState}from'react';import Search from'../components/Search';import Picture from'../components/Picture';import axios from'axios';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";const Homepage=()=>{const[data,setData]=useState([]);const[input,setInput]=useState('');const[page,setPage]=useState(1);const[currentSearch,setCurrentSearch]=useState(\"\");const auth=process.env.REACT_APP_PELEXS_AUTH;const initialURL=\"https://api.pexels.com/v1/curated?page=1&per_page=15\";const searchURL=\"https://api.pexels.com/v1/search?query=\".concat(input,\"&page=1&per_page=15\");const search=async(type,url)=>{if(type==='initial'||type==='search'&&input){let result=await axios.get(url,{headers:{Authorization:auth}});setData(result.data.photos);setCurrentSearch(input);}};const morePicture=async()=>{let newURL='';setPage(page+1);if(currentSearch===\"\"){newURL=\"https://api.pexels.com/v1/curated?page=\".concat(page+1,\"&per_page=15\");}else{newURL=\"https://api.pexels.com/v1/search?query=\".concat(currentSearch,\"&page=\").concat(page+1,\"&per_page=15\");}let result=await axios.get(newURL,{headers:{Authorization:auth}});setData(data.concat(result.data.photos));// 兩個一樣的\n// setData((prev)=>([\n//     ...prev,\n//     ...result.data.photos\n// ]))\n};useEffect(()=>{search('initial',initialURL);},[]);return/*#__PURE__*/_jsxs(\"div\",{style:{minHeight:'100vh'},children:[/*#__PURE__*/_jsx(Search,{search:()=>search('search',searchURL),setInput:setInput}),/*#__PURE__*/_jsx(\"div\",{className:\"pictures\",children:data===null||data===void 0?void 0:data.map(d=>{return/*#__PURE__*/_jsx(Picture,{data:d});})}),/*#__PURE__*/_jsx(\"div\",{className:\"morePicture\",children:/*#__PURE__*/_jsx(\"button\",{onClick:morePicture,children:\"\\u66F4\\u591A\\u5716\\u7247\"})})]});};export default Homepage;","map":{"version":3,"names":["React","useEffect","useState","Search","Picture","axios","jsx","_jsx","jsxs","_jsxs","Homepage","data","setData","input","setInput","page","setPage","currentSearch","setCurrentSearch","auth","process","env","REACT_APP_PELEXS_AUTH","initialURL","searchURL","concat","search","type","url","result","get","headers","Authorization","photos","morePicture","newURL","style","minHeight","children","className","map","d","onClick"],"sources":["/Users/jiayu/search_pelexs/src/pages/Homepage.js"],"sourcesContent":["import React, { useEffect, useState } from 'react'\nimport Search from '../components/Search'\nimport Picture from '../components/Picture'\nimport axios from 'axios'\nconst Homepage = () => {\n  const [data, setData] = useState([])\n  const [input, setInput] = useState('')\n  const [page, setPage] = useState(1)\n  const [currentSearch, setCurrentSearch] = useState(\"\")\n  const auth = process.env.REACT_APP_PELEXS_AUTH\n\n  const initialURL = \"https://api.pexels.com/v1/curated?page=1&per_page=15\"\n\n  const searchURL =`https://api.pexels.com/v1/search?query=${input}&page=1&per_page=15`\n\n  const search = async(type, url) =>{\n      if(type === 'initial' || (type === 'search' && input)){\n        let result = await axios.get(url, {\n          headers:{ Authorization: auth}\n        })\n        setData(result.data.photos)\n        setCurrentSearch(input)\n      }\n  }\n\n  const morePicture = async()=>{\n    let newURL = ''\n    setPage(page +1)\n    if(currentSearch === \"\"){\n      newURL = `https://api.pexels.com/v1/curated?page=${page +1}&per_page=15`\n    }else{\n      newURL =`https://api.pexels.com/v1/search?query=${currentSearch}&page=${page +1}&per_page=15`\n    }\n    let result = await axios.get(newURL, {\n      headers:{ Authorization: auth}\n    })\n    setData(data.concat(result.data.photos))\n    // 兩個一樣的\n    // setData((prev)=>([\n    //     ...prev,\n    //     ...result.data.photos\n    // ]))\n  }\n\n  useEffect(()=>{\n      search('initial',initialURL)\n  }, [])\n\n  return (\n    <div style={{minHeight:'100vh'}}>\n      <Search search={()=> search('search',searchURL)} setInput={setInput}/>\n      <div className='pictures'>\n        {\n          data?.map((d)=>{\n            return(\n              <Picture data={d} />\n            )\n          })\n        }\n      </div>\n      <div className='morePicture'>\n        <button onClick={morePicture}>更多圖片</button>\n      </div>\n    </div>\n  )\n}\n\nexport default Homepage"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}